{"version":"NotebookV1","origId":1079960168519460,"name":"Dynamic Partition Pruning","language":"python","commands":[{"version":"CommandV1","origId":1079960168519461,"guid":"28acfb41-62c4-49fe-a453-11d00e1fdf2e","subtype":"command","commandType":"auto","position":1.0,"command":"spark.conf.set(\"spark.sql.adaptive.enabled\",\"true\")\nspark.conf.set(\"spark.sql.optimizer.dynamicPartitionPruning.enabled\", \"true\")\n","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093323814,"submitTime":1745093323761,"finishTime":1745093323943,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"9ec112c0-6784-44cc-9ad0-557e8afcdae2"},{"version":"CommandV1","origId":1079960168519463,"guid":"1e2ddec9-2aca-408d-9094-f250782e440f","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n**Turning OFF AQE and DPP and AutoBroadcast**","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"935371fc-ee04-4e05-ba0b-995a2b6c24e3"},{"version":"CommandV1","origId":1079960168519476,"guid":"72a8f87b-d08f-4c4d-986b-61ad2829b40f","subtype":"command","commandType":"auto","position":2.5,"command":"%md\n**Preparing the Partitioned Data**","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"2b32917d-69f0-47b2-95ae-b5aa89b42b23"},{"version":"CommandV1","origId":1079960168519478,"guid":"14bcc8da-ccff-413a-a7a5-37ab267c5096","subtype":"command","commandType":"auto","position":3.5,"command":"df.write.format(\"parquet\")\\\n        .mode(\"append\")\\\n        .partitionBy(\"Item_identifier\")\\\n        .option(\"path\",\"/FileStore/rawdata/dpp_partionednew\")\\\n        .save()","commandVersion":16,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093708926,"submitTime":1745093708884,"finishTime":1745093721794,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"81677646-280c-4d58-8db9-355a735047bc"},{"version":"CommandV1","origId":1079960168519479,"guid":"9f0eb803-bca3-48bc-9b56-07589ddde415","subtype":"command","commandType":"auto","position":1.75,"command":"df = spark.read.format(\"csv\")\\\n        .option(\"header\",True)\\\n        .option(\"inferSchema\",True)\\\n        .load(\"/FileStore/rawdata/BigMart_Sales.csv\")\n\ndf = df.limit(8)","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Item_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Weight","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Fat_Content","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Visibility","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_MRP","nullable":true,"type":"double"},{"metadata":{},"name":"Outlet_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Establishment_Year","nullable":true,"type":"integer"},{"metadata":{},"name":"Outlet_Size","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Location_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Outlet_Sales","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093683762,"submitTime":1745093683041,"finishTime":1745093699604,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"13f81237-b4ad-4aec-8a61-5bd6e8a53396"},{"version":"CommandV1","origId":1079960168519480,"guid":"04ddee6b-77d4-425b-b1a4-c6a765bced0a","subtype":"command","commandType":"auto","position":2.125,"command":"df.display()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["FDA15",9.3,"Low Fat",0.016047301,"Dairy",249.8092,"OUT049",1999,"Medium","Tier 1","Supermarket Type1",3735.138],["DRC01",5.92,"Regular",0.019278216,"Soft Drinks",48.2692,"OUT018",2009,"Medium","Tier 3","Supermarket Type2",443.4228],["FDN15",17.5,"Low Fat",0.016760075,"Meat",141.618,"OUT049",1999,"Medium","Tier 1","Supermarket Type1",2097.27],["FDX07",19.2,"Regular",0.0,"Fruits and Vegetables",182.095,"OUT010",1998,null,"Tier 3","Grocery Store",732.38],["NCD19",8.93,"Low Fat",0.0,"Household",53.8614,"OUT013",1987,"High","Tier 3","Supermarket Type1",994.7052],["FDP36",10.395,"Regular",0.0,"Baking Goods",51.4008,"OUT018",2009,"Medium","Tier 3","Supermarket Type2",556.6088],["FDO10",13.65,"Regular",0.012741089,"Snack Foods",57.6588,"OUT013",1987,"High","Tier 3","Supermarket Type1",343.5528],["FDP10",null,"Low Fat",0.127469857,"Snack Foods",107.7622,"OUT027",1985,"Medium","Tier 3","Supermarket Type3",4022.7636]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Item_Identifier","type":"\"string\"","metadata":"{}"},{"name":"Item_Weight","type":"\"double\"","metadata":"{}"},{"name":"Item_Fat_Content","type":"\"string\"","metadata":"{}"},{"name":"Item_Visibility","type":"\"double\"","metadata":"{}"},{"name":"Item_Type","type":"\"string\"","metadata":"{}"},{"name":"Item_MRP","type":"\"double\"","metadata":"{}"},{"name":"Outlet_Identifier","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Establishment_Year","type":"\"integer\"","metadata":"{}"},{"name":"Outlet_Size","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Location_Type","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Type","type":"\"string\"","metadata":"{}"},{"name":"Item_Outlet_Sales","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093703393,"submitTime":1745093703339,"finishTime":1745093704576,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",8]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"0f698b66-0e63-492d-a038-da7a877b891d"},{"version":"CommandV1","origId":1079960168519481,"guid":"c47c335a-e357-4508-a648-1dc25b5c7844","subtype":"command","commandType":"auto","position":4.5,"command":"df.write.format(\"parquet\")\\\n        .mode(\"append\")\\\n        .option(\"path\",\"/FileStore/rawdata/dpp_nonpartioned\")\\\n        .save()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745092778995,"submitTime":1745092778963,"finishTime":1745092780521,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"b339f65b-4b82-4d06-9433-1e0ed9dd2155"},{"version":"CommandV1","origId":1079960168519482,"guid":"b6aeae68-1497-4c83-aa0c-a42f691df1b9","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n**Non Partitioned Data**","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a77415a4-34d6-4f7d-8685-0154f9acc1e0"},{"version":"CommandV1","origId":1079960168519483,"guid":"2d339224-517f-4f78-8066-338184a7fd32","subtype":"command","commandType":"auto","position":5.5,"command":"df2 = spark.read.format(\"parquet\")\\\n          .load(\"/FileStore/rawdata/dpp_nonpartioned\")","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df2","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Item_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Weight","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Fat_Content","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Visibility","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_MRP","nullable":true,"type":"double"},{"metadata":{},"name":"Outlet_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Establishment_Year","nullable":true,"type":"integer"},{"metadata":{},"name":"Outlet_Size","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Location_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Outlet_Sales","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093732014,"submitTime":1745093731970,"finishTime":1745093733639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"8016f81f-7628-4ade-8043-86241a2e04d4"},{"version":"CommandV1","origId":1079960168519484,"guid":"f603837d-bfd8-4ef0-9edb-8ed4b2b943fc","subtype":"command","commandType":"auto","position":5.0,"command":"df1 = spark.read.format(\"parquet\")\\\n          .load(\"/FileStore/rawdata/dpp_partionednew\")","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Item_Weight","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Fat_Content","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Visibility","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_MRP","nullable":true,"type":"double"},{"metadata":{},"name":"Outlet_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Establishment_Year","nullable":true,"type":"integer"},{"metadata":{},"name":"Outlet_Size","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Location_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Outlet_Sales","nullable":true,"type":"double"},{"metadata":{},"name":"Item_identifier","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093723086,"submitTime":1745093723035,"finishTime":1745093727521,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f55d6bfe-a94f-4a64-85af-542add2c4d85"},{"version":"CommandV1","origId":1079960168519485,"guid":"5aa5350c-fb3e-412b-821c-75a7f4e6af94","subtype":"command","commandType":"auto","position":4.75,"command":"%md\n**Dataframes**","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"eb340518-7489-4fdb-9200-fe0a1d8fced8"},{"version":"CommandV1","origId":1079960168519486,"guid":"6a2917b6-2abc-4312-8c74-c58ad434d4c9","subtype":"command","commandType":"auto","position":6.5,"command":"df_join = df1.join(df2.filter(col(\"Item_Identifier\")==\"FDA15\"),df1['Item_Identifier']==df2['Item_Identifier'],\"inner\")","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_join","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"Item_Weight","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Fat_Content","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Visibility","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_MRP","nullable":true,"type":"double"},{"metadata":{},"name":"Outlet_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Establishment_Year","nullable":true,"type":"integer"},{"metadata":{},"name":"Outlet_Size","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Location_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Outlet_Sales","nullable":true,"type":"double"},{"metadata":{},"name":"Item_identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Weight","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Fat_Content","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Visibility","nullable":true,"type":"double"},{"metadata":{},"name":"Item_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_MRP","nullable":true,"type":"double"},{"metadata":{},"name":"Outlet_Identifier","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Establishment_Year","nullable":true,"type":"integer"},{"metadata":{},"name":"Outlet_Size","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Location_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Outlet_Type","nullable":true,"type":"string"},{"metadata":{},"name":"Item_Outlet_Sales","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093781758,"submitTime":1745093781727,"finishTime":1745093781909,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"caa01e23-6078-4740-a594-776479ced4b9"},{"version":"CommandV1","origId":1079960168519487,"guid":"b8c6913e-4701-4422-b467-c64226e0120f","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n**JOINS**","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"c4a98370-f018-45b0-91b6-fe886ced0415"},{"version":"CommandV1","origId":1079960168519488,"guid":"ce263b15-368e-4a0c-8fd2-6b0f681a9d9c","subtype":"command","commandType":"auto","position":7.5,"command":"df_join.display()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[[9.3,"Low Fat",0.016047301,"Dairy",249.8092,"OUT049",1999,"Medium","Tier 1","Supermarket Type1",3735.138,"FDA15","FDA15",9.3,"Low Fat",0.016047301,"Dairy",249.8092,"OUT049",1999,"Medium","Tier 1","Supermarket Type1",3735.138]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"Item_Weight","type":"\"double\"","metadata":"{}"},{"name":"Item_Fat_Content","type":"\"string\"","metadata":"{}"},{"name":"Item_Visibility","type":"\"double\"","metadata":"{}"},{"name":"Item_Type","type":"\"string\"","metadata":"{}"},{"name":"Item_MRP","type":"\"double\"","metadata":"{}"},{"name":"Outlet_Identifier","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Establishment_Year","type":"\"integer\"","metadata":"{}"},{"name":"Outlet_Size","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Location_Type","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Type","type":"\"string\"","metadata":"{}"},{"name":"Item_Outlet_Sales","type":"\"double\"","metadata":"{}"},{"name":"Item_identifier","type":"\"string\"","metadata":"{}"},{"name":"Item_Identifier","type":"\"string\"","metadata":"{}"},{"name":"Item_Weight","type":"\"double\"","metadata":"{}"},{"name":"Item_Fat_Content","type":"\"string\"","metadata":"{}"},{"name":"Item_Visibility","type":"\"double\"","metadata":"{}"},{"name":"Item_Type","type":"\"string\"","metadata":"{}"},{"name":"Item_MRP","type":"\"double\"","metadata":"{}"},{"name":"Outlet_Identifier","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Establishment_Year","type":"\"integer\"","metadata":"{}"},{"name":"Outlet_Size","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Location_Type","type":"\"string\"","metadata":"{}"},{"name":"Outlet_Type","type":"\"string\"","metadata":"{}"},{"name":"Item_Outlet_Sales","type":"\"double\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093782295,"submitTime":1745093782269,"finishTime":1745093790849,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"050bc5ef-00e7-40ad-bc54-863bf580bb69"},{"version":"CommandV1","origId":1079960168519489,"guid":"1275df02-2678-4072-a869-5b48b13c02c6","subtype":"command","commandType":"auto","position":8.5,"command":"df_join.explain()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=true\n+- == Final Plan ==\n   *(2) BroadcastHashJoin [Item_Identifier#118], [Item_Identifier#131], Inner, BuildRight, false, true\n   :- *(2) ColumnarToRow\n   :  +- FileScan parquet [Item_Weight#107,Item_Fat_Content#108,Item_Visibility#109,Item_Type#110,Item_MRP#111,Outlet_Identifier#112,Outlet_Establishment_Year#113,Outlet_Size#114,Outlet_Location_Type#115,Outlet_Type#116,Item_Outlet_Sales#117,Item_identifier#118] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[dbfs:/FileStore/rawdata/dpp_partionednew], PartitionFilters: [isnotnull(Item_identifier#118), (Item_identifier#118 = FDA15)], PushedFilters: [], ReadSchema: struct<Item_Weight:double,Item_Fat_Content:string,Item_Visibility:double,Item_Type:string,Item_MR...\n   +- ShuffleQueryStage 0, Statistics(sizeInBytes=176.0 B, rowCount=1, isRuntime=true)\n      +- Exchange SinglePartition, EXECUTOR_BROADCAST, [plan_id=187]\n         +- *(1) Filter (isnotnull(Item_Identifier#131) AND (Item_Identifier#131 = FDA15))\n            +- *(1) ColumnarToRow\n               +- FileScan parquet [Item_Identifier#131,Item_Weight#132,Item_Fat_Content#133,Item_Visibility#134,Item_Type#135,Item_MRP#136,Outlet_Identifier#137,Outlet_Establishment_Year#138,Outlet_Size#139,Outlet_Location_Type#140,Outlet_Type#141,Item_Outlet_Sales#142] Batched: true, DataFilters: [isnotnull(Item_Identifier#131), (Item_Identifier#131 = FDA15)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[dbfs:/FileStore/rawdata/dpp_nonpartioned], PartitionFilters: [], PushedFilters: [IsNotNull(Item_Identifier), EqualTo(Item_Identifier,FDA15)], ReadSchema: struct<Item_Identifier:string,Item_Weight:double,Item_Fat_Content:string,Item_Visibility:double,I...\n+- == Initial Plan ==\n   BroadcastHashJoin [Item_Identifier#118], [Item_Identifier#131], Inner, BuildRight, false, true\n   :- FileScan parquet [Item_Weight#107,Item_Fat_Content#108,Item_Visibility#109,Item_Type#110,Item_MRP#111,Outlet_Identifier#112,Outlet_Establishment_Year#113,Outlet_Size#114,Outlet_Location_Type#115,Outlet_Type#116,Item_Outlet_Sales#117,Item_identifier#118] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[dbfs:/FileStore/rawdata/dpp_partionednew], PartitionFilters: [isnotnull(Item_identifier#118), (Item_identifier#118 = FDA15)], PushedFilters: [], ReadSchema: struct<Item_Weight:double,Item_Fat_Content:string,Item_Visibility:double,Item_Type:string,Item_MR...\n   +- Exchange SinglePartition, EXECUTOR_BROADCAST, [plan_id=171]\n      +- Filter (isnotnull(Item_Identifier#131) AND (Item_Identifier#131 = FDA15))\n         +- FileScan parquet [Item_Identifier#131,Item_Weight#132,Item_Fat_Content#133,Item_Visibility#134,Item_Type#135,Item_MRP#136,Outlet_Identifier#137,Outlet_Establishment_Year#138,Outlet_Size#139,Outlet_Location_Type#140,Outlet_Type#141,Item_Outlet_Sales#142] Batched: true, DataFilters: [isnotnull(Item_Identifier#131), (Item_Identifier#131 = FDA15)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[dbfs:/FileStore/rawdata/dpp_nonpartioned], PartitionFilters: [], PushedFilters: [IsNotNull(Item_Identifier), EqualTo(Item_Identifier,FDA15)], ReadSchema: struct<Item_Identifier:string,Item_Weight:double,Item_Fat_Content:string,Item_Visibility:double,I...\n\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093958167,"submitTime":1745093958140,"finishTime":1745093958311,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",3308]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"e81369d2-6112-44c1-a43c-740265c48e54"},{"version":"CommandV1","origId":1079960168519490,"guid":"5067f1c6-dcdf-4c0a-89e6-00c2dd0f0e0b","subtype":"command","commandType":"auto","position":6.25,"command":"from pyspark.sql.functions import *","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745093780787,"submitTime":1745093780741,"finishTime":1745093780907,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"9916e15e-a6b1-4824-928f-aa7ee09db6cf"},{"version":"CommandV1","origId":1079960168519491,"guid":"5407108b-3372-47db-bc98-52805f31e047","subtype":"command","commandType":"auto","position":9.5,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"a74de063-c223-4268-a5e2-23aad37f98e9"}],"dashboards":[],"guid":"d0dbfcfe-afc8-4df9-bc75-581f2956868d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE","environmentMetadata":{"client":"1","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null}