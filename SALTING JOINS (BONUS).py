{"version":"NotebookV1","origId":1627983421044711,"name":"SALTING JOINS (BONUS)","language":"python","commands":[{"version":"CommandV1","origId":1627983421044712,"guid":"0e371370-11c3-4375-91b5-afd1c7fb20f2","subtype":"command","commandType":"auto","position":1.0,"command":"from pyspark.sql import SparkSession\n\nspark = SparkSession.builder.getOrCreate()\n\ntransactions_data = [(\"A\", 100), (\"A\", 200), (\"A\", 300), (\"B\", 150), (\"C\", 250)]\ntransactions_df = spark.createDataFrame(transactions_data, [\"user_id\", \"amount\"])\n\nusers_data = [(\"A\", \"India\"), (\"B\", \"USA\"), (\"C\", \"UK\")]\nusers_df = spark.createDataFrame(users_data, [\"user_id\", \"country\"])\n","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"transactions_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"amount","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null},{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105238969,"submitTime":1745105060748,"finishTime":1745105250989,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"0d8b908f-1cf8-4533-bd50-555c529e1d01"},{"version":"CommandV1","origId":1627983421044714,"guid":"ce414120-d8b7-49c7-8e69-0de3c3758a4c","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.sql.functions import *\n\nsalt_count = 3\n\n# Add a random salt\ntransactions_salted = transactions_df.withColumn(\"salt\", floor(rand() * salt_count))\n\n# Create salted user_id\ntransactions_salted = transactions_salted.withColumn(\"salted_user_id\", concat_ws(\"_\", \"user_id\", \"salt\"))\n","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"transactions_salted","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"amount","nullable":true,"type":"long"},{"metadata":{},"name":"salt","nullable":true,"type":"long"},{"metadata":{},"name":"salted_user_id","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105332651,"submitTime":1745105332608,"finishTime":1745105332881,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"519a320e-d775-4008-b4ce-c562b91322d9"},{"version":"CommandV1","origId":1627983421044715,"guid":"9a3ea871-53a1-497e-a980-1de12aa2846f","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n**Create the Dataframes**","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ee23c0b7-8099-4528-a30d-4155bec2e335"},{"version":"CommandV1","origId":1627983421044716,"guid":"4d2a4324-9747-4a89-923b-7c18de1966c6","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n**Salt the transaction_df**","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"ea87a2c6-aac9-452a-92cd-e2241fe52fbb"},{"version":"CommandV1","origId":1627983421044717,"guid":"d501b779-0165-4886-82cf-d140c4ac5951","subtype":"command","commandType":"auto","position":3.0,"command":"from pyspark.sql.functions import explode, array, lit\n\n# Create array of salt values [0,1,2] for each row\nusers_df = users_df.withColumn(\"salt\", array([lit(i) for i in range(salt_count)]))\n\n# Exploding the values of the array \nusers_expanded = users_df.withColumn(\"salt\", explode(col('salt')))\n\n# Create salted user_id\nusers_expanded = users_expanded.withColumn(\"salted_user_id\", concat_ws(\"_\", \"user_id\", \"salt\"))\n","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"},{"metadata":{},"name":"salt","nullable":false,"type":{"containsNull":false,"elementType":"integer","type":"array"}}],"type":"struct"},"tableIdentifier":null},{"name":"users_expanded","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"},{"metadata":{},"name":"salt","nullable":false,"type":"integer"},{"metadata":{},"name":"salted_user_id","nullable":false,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105335227,"submitTime":1745105335186,"finishTime":1745105335484,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"f4bcd6af-b4f3-4c1f-8784-d3c8429708c7"},{"version":"CommandV1","origId":1627983421044718,"guid":"3d0f32a7-4d4d-465d-97e7-e6a2edd6096b","subtype":"command","commandType":"auto","position":2.5,"command":"%md\n**Adding Salt to users_df (all the values of salt) and then Exploding it**","commandVersion":6,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"6ec38ca3-0c82-46ca-9c2b-d0c58dea9a09"},{"version":"CommandV1","origId":1627983421044719,"guid":"99616ca5-938d-422b-aa3e-e0542ea7bc4a","subtype":"command","commandType":"auto","position":4.0,"command":"# Displaying users_expanded\n\nusers_expanded.display()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["A","India",0,"A_0"],["A","India",1,"A_1"],["A","India",2,"A_2"],["B","USA",0,"B_0"],["B","USA",1,"B_1"],["B","USA",2,"B_2"],["C","UK",0,"C_0"],["C","UK",1,"C_1"],["C","UK",2,"C_2"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"user_id","type":"\"string\"","metadata":"{}"},{"name":"country","type":"\"string\"","metadata":"{}"},{"name":"salt","type":"\"integer\"","metadata":"{}"},{"name":"salted_user_id","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105396358,"submitTime":1745105396311,"finishTime":1745105397738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",9]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"3966c903-7f8e-4ba1-af5f-660779260a5e"},{"version":"CommandV1","origId":1627983421044720,"guid":"716cc7ab-8153-47d7-81cb-f5b5a2ead08c","subtype":"command","commandType":"auto","position":2.25,"command":"# Displaying transactions_df\ntransactions_salted.display()","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["A",100,1,"A_1"],["A",200,0,"A_0"],["A",300,0,"A_0"],["B",150,0,"B_0"],["C",250,2,"C_2"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"user_id","type":"\"string\"","metadata":"{}"},{"name":"amount","type":"\"long\"","metadata":"{}"},{"name":"salt","type":"\"long\"","metadata":"{}"},{"name":"salted_user_id","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105374245,"submitTime":1745105374219,"finishTime":1745105384485,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",5]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"e0040bf8-16af-48ea-b3a6-5af8963a3bfd"},{"version":"CommandV1","origId":1627983421044721,"guid":"346bd186-e5e2-48c7-8104-8546a2ef1286","subtype":"command","commandType":"auto","position":5.0,"command":"joined_df = transactions_salted.join(users_expanded, on=\"salted_user_id\", how=\"inner\")","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"joined_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"salted_user_id","nullable":false,"type":"string"},{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"amount","nullable":true,"type":"long"},{"metadata":{},"name":"salt","nullable":true,"type":"long"},{"metadata":{},"name":"user_id","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"},{"metadata":{},"name":"salt","nullable":false,"type":"integer"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105474714,"submitTime":1745105474680,"finishTime":1745105474928,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"dcd4f3fb-7793-492c-8ff7-4f9fdc575fcf"},{"version":"CommandV1","origId":1627983421044722,"guid":"fdf7233c-7dff-4c0d-9db2-6e99a2915a37","subtype":"command","commandType":"auto","position":4.5,"command":"%md\n**Applying JOIN**","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"2e21d0f6-85a4-467a-9627-949b0166e5fa"},{"version":"CommandV1","origId":1627983421044723,"guid":"d41a5f6e-b4f4-4121-98b0-e04286243ddf","subtype":"command","commandType":"auto","position":6.0,"command":"joined_df.display()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["A_0","A",200,0,"A","India",0],["A_0","A",300,0,"A","India",0],["A_1","A",100,1,"A","India",1],["B_0","B",150,0,"B","USA",0],["C_2","C",250,2,"C","UK",2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"salted_user_id","type":"\"string\"","metadata":"{}"},{"name":"user_id","type":"\"string\"","metadata":"{}"},{"name":"amount","type":"\"long\"","metadata":"{}"},{"name":"salt","type":"\"long\"","metadata":"{}"},{"name":"user_id","type":"\"string\"","metadata":"{}"},{"name":"country","type":"\"string\"","metadata":"{}"},{"name":"salt","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1745105479680,"submitTime":1745105479606,"finishTime":1745105484590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",5]],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"cc352431-d0ac-4727-b46b-27d7631bb403"},{"version":"CommandV1","origId":1627983421044724,"guid":"42e7a7cf-972c-4d14-a682-1098243b739a","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"tableResultSettingsMap":{},"nuid":"5fe03beb-91e5-416a-b7eb-4e21ba08d3de"}],"dashboards":[],"guid":"a5a9f34b-fbeb-49b5-8401-ff4ec4d2db8f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4},"reposExportFormat":"SOURCE","environmentMetadata":{"client":"1","base_environment":""},"computePreferences":null,"inputWidgetPreferences":null}